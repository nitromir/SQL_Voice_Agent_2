(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7582:function(t,e,a){Promise.resolve().then(a.bind(a,7614))},7614:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return A}});var r=a(7437),s=a(2265),o=a(3542),n=a.n(o);let i=t=>{let{isMicActive:e,isProcessing:a,onClick:s,hasMessages:o,lastMessageIsAssistant:i,isMuted:l,onMuteToggle:c}=t;return(0,r.jsxs)("div",{style:{position:"fixed",bottom:"1.5rem",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",gap:"1rem",zIndex:100},children:[(0,r.jsx)("div",{onClick:c,className:n().muteButton,"data-muted":l,children:(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{transition:"transform 0.3s ease-out",opacity:l?1:.6},children:(0,r.jsx)("path",{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9l4.19 4.18L21 20.73 4.27 3z",fill:l?"#fff":"#4169E1"})})}),(0,r.jsxs)("div",{className:n().micButton,"data-active":e,onClick:s,children:[a&&(0,r.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",border:"3px solid rgba(65, 105, 225, 0.1)",borderTop:"3px solid #4169E1",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,r.jsxs)("svg",{className:n().micIcon,style:{animation:e||o&&i?"pulseScale 1s ease-in-out infinite":"none"},viewBox:"0 0 24 24",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V21h2v-3.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"}),(0,r.jsx)("path",{d:"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})]})]})]})};var l=a(6733),c=a.n(l);let d=t=>{let{messages:e}=t;if(0===e.length)return null;let a=e[e.length-1];return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:c().messageContainer,children:(0,r.jsxs)("div",{className:"".concat(c().message," ").concat("assistant"===a.type?c().assistant:c().user),children:[a.text,(0,r.jsx)("div",{style:{position:"absolute",bottom:"-4px",["assistant"===a.type?"left":"right"]:"8px",width:"8px",height:"8px",background:"assistant"===a.type?"rgba(65, 105, 225, 0.15)":"rgba(135, 206, 235, 0.15)",transform:"rotate(45deg)",borderBottom:"assistant"===a.type?"1px solid rgba(65, 105, 225, 0.2)":"1px solid rgba(135, 206, 235, 0.2)",borderRight:"assistant"===a.type?"1px solid rgba(65, 105, 225, 0.2)":"1px solid rgba(135, 206, 235, 0.2)"}})]},a.id)})})};var u=a(29),m=a.n(u);let f=()=>{let[t,e]=(0,s.useState)([]);return(0,s.useEffect)(()=>{e([...Array(30)].map(()=>({top:100*Math.random(),left:100*Math.random(),duration:8+15*Math.random(),type:Math.floor(3*Math.random())})))},[]),(0,r.jsx)(r.Fragment,{children:t.map((t,e)=>(0,r.jsx)("div",{style:{position:"fixed",width:"3px",height:"3px",background:"#4169E1",boxShadow:"0 0 10px #4169E1",borderRadius:"50%",top:"".concat(t.top,"%"),left:"".concat(t.left,"%"),animation:"float".concat(t.type," ").concat(t.duration,"s ease-in-out infinite"),opacity:.05,zIndex:1}},e))})},h=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, #000724 0%, #1e1347 100%)",zIndex:0},className:"jsx-da220f8ab2bf85f9"}),(0,r.jsx)("div",{style:{position:"fixed",top:"-50%",left:"-50%",right:"-50%",bottom:"-50%",width:"200%",height:"200%",background:"transparent url(http://assets.iceable.com/img/noise-transparent.png) repeat 0 0",animation:"moveBackgroundDiagonal 15s linear infinite",opacity:.1,zIndex:1},className:"jsx-da220f8ab2bf85f9"}),(0,r.jsx)(f,{}),(0,r.jsx)(m(),{id:"da220f8ab2bf85f9",children:'@import url("https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;600;700&display=swap");@-webkit-keyframes moveBackgroundDiagonal{0%{-webkit-transform:translate(0,0)rotate(0deg);transform:translate(0,0)rotate(0deg)}100%{-webkit-transform:translate(-50%,-50%)rotate(5deg);transform:translate(-50%,-50%)rotate(5deg)}}@-moz-keyframes moveBackgroundDiagonal{0%{-moz-transform:translate(0,0)rotate(0deg);transform:translate(0,0)rotate(0deg)}100%{-moz-transform:translate(-50%,-50%)rotate(5deg);transform:translate(-50%,-50%)rotate(5deg)}}@-o-keyframes moveBackgroundDiagonal{0%{-o-transform:translate(0,0)rotate(0deg);transform:translate(0,0)rotate(0deg)}100%{-o-transform:translate(-50%,-50%)rotate(5deg);transform:translate(-50%,-50%)rotate(5deg)}}@keyframes moveBackgroundDiagonal{0%{-webkit-transform:translate(0,0)rotate(0deg);-moz-transform:translate(0,0)rotate(0deg);-o-transform:translate(0,0)rotate(0deg);transform:translate(0,0)rotate(0deg)}100%{-webkit-transform:translate(-50%,-50%)rotate(5deg);-moz-transform:translate(-50%,-50%)rotate(5deg);-o-transform:translate(-50%,-50%)rotate(5deg);transform:translate(-50%,-50%)rotate(5deg)}}@-webkit-keyframes float0{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(100px,-100px)scale(1.5)rotate(180deg);transform:translate(100px,-100px)scale(1.5)rotate(180deg);opacity:.6}}@-moz-keyframes float0{0%,100%{-moz-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-moz-transform:translate(100px,-100px)scale(1.5)rotate(180deg);transform:translate(100px,-100px)scale(1.5)rotate(180deg);opacity:.6}}@-o-keyframes float0{0%,100%{-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-o-transform:translate(100px,-100px)scale(1.5)rotate(180deg);transform:translate(100px,-100px)scale(1.5)rotate(180deg);opacity:.6}}@keyframes float0{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);-moz-transform:translate(0,0)scale(1)rotate(0deg);-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(100px,-100px)scale(1.5)rotate(180deg);-moz-transform:translate(100px,-100px)scale(1.5)rotate(180deg);-o-transform:translate(100px,-100px)scale(1.5)rotate(180deg);transform:translate(100px,-100px)scale(1.5)rotate(180deg);opacity:.6}}@-webkit-keyframes float1{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);opacity:.6}}@-moz-keyframes float1{0%,100%{-moz-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-moz-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);opacity:.6}}@-o-keyframes float1{0%,100%{-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-o-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);opacity:.6}}@keyframes float1{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);-moz-transform:translate(0,0)scale(1)rotate(0deg);-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);-moz-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);-o-transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);transform:translate(-100px,-150px)scale(1.5)rotate(-180deg);opacity:.6}}@-webkit-keyframes float2{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(50px,-200px)scale(1.5)rotate(90deg);transform:translate(50px,-200px)scale(1.5)rotate(90deg);opacity:.6}}@-moz-keyframes float2{0%,100%{-moz-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-moz-transform:translate(50px,-200px)scale(1.5)rotate(90deg);transform:translate(50px,-200px)scale(1.5)rotate(90deg);opacity:.6}}@-o-keyframes float2{0%,100%{-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-o-transform:translate(50px,-200px)scale(1.5)rotate(90deg);transform:translate(50px,-200px)scale(1.5)rotate(90deg);opacity:.6}}@keyframes float2{0%,100%{-webkit-transform:translate(0,0)scale(1)rotate(0deg);-moz-transform:translate(0,0)scale(1)rotate(0deg);-o-transform:translate(0,0)scale(1)rotate(0deg);transform:translate(0,0)scale(1)rotate(0deg);opacity:.2}50%{-webkit-transform:translate(50px,-200px)scale(1.5)rotate(90deg);-moz-transform:translate(50px,-200px)scale(1.5)rotate(90deg);-o-transform:translate(50px,-200px)scale(1.5)rotate(90deg);transform:translate(50px,-200px)scale(1.5)rotate(90deg);opacity:.6}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes pulseScale{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);transform:scale(1.1)}100%{-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes pulseScale{0%{-moz-transform:scale(1);transform:scale(1)}50%{-moz-transform:scale(1.1);transform:scale(1.1)}100%{-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes pulseScale{0%{-o-transform:scale(1);transform:scale(1)}50%{-o-transform:scale(1.1);transform:scale(1.1)}100%{-o-transform:scale(1);transform:scale(1)}}@keyframes pulseScale{0%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1)}100%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}body{margin:0;padding:0;min-height:100vh;font-family:"Plus Jakarta Sans",sans-serif;background:#000724;overflow:hidden}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}'})]});var g=a(7625),p=a(7031),x=a(6940),b=a(7059),v=a(2994),y=a(8147),k=a(2190),w=a(1699),S=a(1156),C=a(4061),E=a(5169),j=a(3574),z=a(407);let D=["#ffc000","#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#ffcc5c"];function T(t){let{visualization:e}=t,[a,o]=(0,s.useState)(!1);(0,s.useEffect)(()=>(o(!0),()=>o(!1)),[]);let n=e.data.map(t=>({name:t.label,value:t.value}));return(0,r.jsxs)("div",{style:{position:"relative",width:"90%",maxWidth:"800px",margin:"0 auto",background:"rgba(0, 0, 0, 0.9)",padding:"1.5rem",borderRadius:"1rem",color:"#ffc000",border:"1px solid rgba(255, 192, 0, 0.3)",boxShadow:"0 0 30px rgba(255, 192, 0, 0.15)",opacity:a?1:0,transform:"scale(".concat(a?1:.9,")"),transition:"all 0.3s ease-out",marginBottom:"2rem"},children:[(0,r.jsx)("h3",{style:{fontSize:"1.4rem",fontWeight:"bold",marginBottom:"1rem",textAlign:"center",textShadow:"0 0 10px rgba(255, 192, 0, 0.2)"},children:e.title}),(()=>{switch(e.type){case"bar":return(0,r.jsx)(g.h,{width:"100%",height:300,children:(0,r.jsxs)(p.v,{data:n,children:[(0,r.jsx)(x.q,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),(0,r.jsx)(b.K,{dataKey:"name",stroke:"#fff"}),(0,r.jsx)(v.B,{stroke:"#fff"}),(0,r.jsx)(y.u,{contentStyle:{background:"rgba(0,0,0,0.8)",border:"1px solid rgba(255,192,0,0.3)",color:"#fff"}}),(0,r.jsx)(k.D,{}),(0,r.jsx)(w.$,{dataKey:"value",fill:"#ffc000"})]})});case"line":return(0,r.jsx)(g.h,{width:"100%",height:300,children:(0,r.jsxs)(S.w,{data:n,children:[(0,r.jsx)(x.q,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),(0,r.jsx)(b.K,{dataKey:"name",stroke:"#fff"}),(0,r.jsx)(v.B,{stroke:"#fff"}),(0,r.jsx)(y.u,{contentStyle:{background:"rgba(0,0,0,0.8)",border:"1px solid rgba(255,192,0,0.3)",color:"#fff"}}),(0,r.jsx)(k.D,{}),(0,r.jsx)(C.x,{type:"monotone",dataKey:"value",stroke:"#ffc000",strokeWidth:2})]})});case"pie":return(0,r.jsx)(g.h,{width:"100%",height:300,children:(0,r.jsxs)(E.u,{children:[(0,r.jsx)(j.b,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:t=>{let{name:e,percent:a}=t;return"".concat(e," ").concat((100*a).toFixed(0),"%")},outerRadius:100,fill:"#8884d8",dataKey:"value",children:n.map((t,e)=>(0,r.jsx)(z.b,{fill:D[e%D.length]},"cell-".concat(e)))}),(0,r.jsx)(y.u,{contentStyle:{background:"rgba(0,0,0,0.8)",border:"1px solid rgba(255,192,0,0.3)",color:"#fff"}}),(0,r.jsx)(k.D,{})]})});default:return null}})()]})}class M{async initialize(t){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:t?{deviceId:{exact:t},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:24e3,channelCount:1}:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:24e3,channelCount:1}}),this.setMuted(this.isMuted)}catch(t){throw console.error("Failed to initialize audio:",t),t}}cleanup(){this.stream&&(this.stream.getTracks().forEach(t=>t.stop()),this.stream=null)}setMuted(t){this.isMuted=t,this.stream&&this.stream.getAudioTracks().forEach(e=>{e.enabled=!t})}getStream(){return this.stream}constructor(){this.stream=null,this.isMuted=!1}}class N{async initialize(){this.audioContext=new AudioContext({sampleRate:24e3,latencyHint:"interactive"}),await this.audioContext.audioWorklet.addModule("/audioProcessor.js"),this.workletNode=new AudioWorkletNode(this.audioContext,"audio-processor",{numberOfInputs:1,numberOfOutputs:1,channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",processorOptions:{sampleRate:24e3}}),this.workletNode.port.onmessage=t=>{if("audio"===t.data.type&&t.data.audio){var e,a;null===(e=this.onAudioData)||void 0===e||e.call(this,t.data.audio),null===(a=this.onAudioLevel)||void 0===a||a.call(this,t.data.level)}}}connectStream(t){if(!this.audioContext||!this.workletNode)throw Error("AudioProcessor not initialized");this.source&&this.source.disconnect(),this.source=this.audioContext.createMediaStreamSource(t),this.source.connect(this.workletNode)}setAudioDataHandler(t){this.onAudioData=t}setAudioLevelHandler(t){this.onAudioLevel=t}cleanup(){this.source&&(this.source.disconnect(),this.source=null),this.workletNode&&(this.workletNode.disconnect(),this.workletNode=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null)}constructor(){this.audioContext=null,this.workletNode=null,this.source=null}}var H=a(4588);class I{logDebug(t){for(var e=arguments.length,a=Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];console.log("[Ultravox] ".concat(t),...a),this.debugHandler&&this.debugHandler({lastAction:t})}mapUltravoxStatusToConnectionState(t){switch(t){case H.sL.DISCONNECTED:return"disconnected";case H.sL.CONNECTING:return"connecting";case H.sL.IDLE:case H.sL.LISTENING:case H.sL.THINKING:case H.sL.SPEAKING:return"connected";default:return"new"}}isConnected(){return"connected"===this.connectionState}async connect(){try{if(this.logDebug("Starting Ultravox connection..."),this.isReconnecting)return;this.isReconnecting=!0,this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.updateConnectionState("connecting");let t=await fetch("/api/ultravox-call",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to create Ultravox call: ".concat(t.statusText));let{joinUrl:e}=await t.json();if(!e)throw Error("No join URL received from server");if(this.isReconnecting&&await new Promise(t=>setTimeout(t,this.retryDelay)),this.ultravoxSession){try{await this.ultravoxSession.leaveCall()}catch(t){console.error("Error leaving previous call:",t)}this.ultravoxSession=null}this.ultravoxSession=new this.ultravoxSessionClass,this.removeEventHandlers(),this.setupEventHandlers(),this.ultravoxSession.registerToolImplementations({query_database:async t=>{try{this.logDebug("Executing query:",t.query);let e=await fetch("/api/sql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t.query,sessionId:this.sessionId})});if(!e.ok)throw Error("SQL query failed");let a=await e.json();return this.logDebug("Query result:",a),a.response}catch(t){return console.error("Error executing SQL query:",t),"Failed to execute query: "+(t instanceof Error?t.message:String(t))}},visualize_data:async t=>{try{return this.logDebug("Creating visualization:",t),this.visualizationHandler&&this.visualizationHandler(null),this.visualizationHandler&&this.visualizationHandler({type:t.type,title:t.title||"",data:t.data}),JSON.stringify({success:!0})}catch(t){throw console.error("Error creating visualization:",t),Error("Failed to create visualization")}}}),await this.ultravoxSession.joinCall(e);let a=Date.now();for(this.connectionTimeout=setTimeout(()=>{"connected"!==this.connectionState&&(this.logDebug("Connection timeout - failed to establish connection"),this.updateConnectionState("disconnected"))},1e4);Date.now()-a<1e4&&(!this.ultravoxSession||this.ultravoxSession.status===H.sL.DISCONNECTED||this.ultravoxSession.status===H.sL.CONNECTING);)await new Promise(t=>setTimeout(t,100));if(this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),!this.ultravoxSession||this.ultravoxSession.status===H.sL.DISCONNECTED)throw Error("Connection timeout - failed to establish connection");this.ultravoxSession.addEventListener("track",t=>{if("audio"===t.track.kind&&this.audioElement){let e=new MediaStream([t.track]);this.audioElement.srcObject=e}})}catch(t){throw this.isReconnecting=!1,this.logDebug("Connection error:",t),this.updateConnectionState("failed"),t}finally{this.isReconnecting=!1}}removeEventHandlers(){this.ultravoxSession&&(Object.entries(this.eventHandlers).forEach(t=>{let[e,a]=t;if(a){var r;null===(r=this.ultravoxSession)||void 0===r||r.removeEventListener(e,a)}}),this.eventHandlers={status:null,transcripts:null,track:null})}setupEventHandlers(){this.ultravoxSession&&(this.eventHandlers.status=t=>{if(!this.ultravoxSession)return;let e=this.ultravoxSession.status,a=this.mapUltravoxStatusToConnectionState(e);this.updateConnectionState(a),e===H.sL.DISCONNECTED&&this.disconnect()},this.eventHandlers.transcripts=t=>{if(this.messageHandler&&this.ultravoxSession){let t=this.ultravoxSession.transcripts,e=t[t.length-1];e&&"agent"===e.speaker&&this.messageHandler({id:String(Date.now()),type:"assistant",text:e.text,partial:!e.isFinal})}},this.eventHandlers.track=t=>{if("audio"===t.track.kind&&this.audioElement){let e=new MediaStream([t.track]);this.audioElement.srcObject=e}},Object.entries(this.eventHandlers).forEach(t=>{let[e,a]=t;a&&this.ultravoxSession&&this.ultravoxSession.addEventListener(e,a)}))}updateConnectionState(t){this.connectionState=t,this.stateChangeHandler&&this.stateChangeHandler(t)}async disconnect(){try{if(this.isDisconnecting)return;this.isReconnecting=!1,this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.isDisconnecting=!0,this.mediaStream&&(this.mediaStream.getTracks().forEach(t=>t.stop()),this.mediaStream=null);let t=this.ultravoxSession;if(this.ultravoxSession=null,t)try{await t.leaveCall()}catch(t){console.error("Error leaving call:",t)}this.audioElement&&(this.audioElement.srcObject=null,this.audioElement=null,this.mediaStream=null),this.removeEventHandlers(),this.updateConnectionState("disconnected"),this.isDisconnecting=!1}catch(t){throw this.logDebug("Disconnection error:",t),this.isDisconnecting=!1,t}}async processAudio(t){}async addAudioTrack(t,e){if(!this.ultravoxSession)throw Error("No active Ultravox session");try{this.mediaStream=e;let t=this.ultravoxSession.peerConnection;t&&e.getTracks().forEach(a=>{t.addTrack(a,e)}),this.logDebug("Added audio track to Ultravox session")}catch(t){throw this.logDebug("Error adding audio track:",t),t}}setStateChangeHandler(t){this.stateChangeHandler=t}setMessageHandler(t){this.messageHandler=t}setVisualizationHandler(t){this.visualizationHandler=t}setDebugHandler(t){this.debugHandler=t}constructor(){this.audioElement=null,this.audioProcessor=null,this.sessionId=null,this.ultravoxSession=null,this.connectionState="new",this.isDisconnecting=!1,this.mediaStream=null,this.isReconnecting=!1,this.connectionTimeout=null,this.retryDelay=2e3,this.eventHandlers={status:null,transcripts:null,track:null},this.audioElement=new Audio,this.audioElement.autoplay=!0,this.ultravoxSessionClass=H.Fk,this.audioProcessor=new N,this.sessionId=Math.floor(1e6*Math.random())}}function A(){let{isMicActive:t,isProcessing:e,isConnected:a,isMuted:o,messages:n,debugInfo:l,currentVisualization:c,isVisualizationFading:u,selectedModel:m,startRecording:f,stopRecording:g,toggleMute:p}=function(){let[t,e]=(0,s.useState)(!1),[a,r]=(0,s.useState)(!1),[o,n]=(0,s.useState)(!1),[i,l]=(0,s.useState)([]),[c,d]=(0,s.useState)({}),[u,m]=(0,s.useState)(!1),[f,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1),[x]=(0,s.useState)("ultravox"),[b,v]=(0,s.useState)(0),y=(0,s.useRef)(new M),k=(0,s.useRef)(null),w=(0,s.useRef)(null),S=(0,s.useCallback)(function(t){for(var e=arguments.length,a=Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];console.log(t,...a),d(e=>({...e,lastAction:t}))},[]),C=(0,s.useCallback)(()=>{k.current&&(k.current.disconnect(),k.current=null),w.current&&(w.current.getTracks().forEach(t=>t.stop()),w.current=null),y.current&&y.current.cleanup(),e(!1),m(!1),l([])},[]),E=(0,s.useCallback)(t=>{S("Connection state changed: ".concat(t)),"failed"===t||"disconnected"===t?("failed"===t&&d(e=>({...e,lastError:"Connection failed",lastAction:t})),"disconnected"!==t&&C()):m("connected"===t)},[S,C]),j=(0,s.useCallback)(t=>{S("Received message:",t),t.delta?l(e=>e.find(e=>e.id===t.id&&e.partial)?e.map(e=>e.id===t.id?{...e,text:e.text+t.text}:e):[...e,t]):t.partial?l(e=>[...e,t]):l(e=>[...e.filter(e=>e.id!==t.id),t])},[S]),z=(0,s.useCallback)(t=>{h(t)},[]),D=(0,s.useCallback)(async()=>{try{if(v(0),r(!0),d({}),!k.current){k.current=new I,k.current.setStateChangeHandler(E),k.current.setMessageHandler(j),k.current.setVisualizationHandler(z),k.current.setDebugHandler(d);try{if(await k.current.connect(),!k.current.isConnected()&&b<2){v(t=>t+1),d(t=>({...t,lastAction:"Retrying connection (attempt ".concat(b+1,"/").concat(2,")...")})),await D();return}let t=Date.now();for(;Date.now()-t<15e3&&!k.current.isConnected();)await new Promise(t=>setTimeout(t,100));if(!k.current.isConnected()&&b>=2)throw Error("Connection timeout - connection not established")}catch(t){S("Connection error:",t),d(e=>({...e,lastError:t instanceof Error?t.message:String(t),lastAction:"Failed to establish connection"})),C();return}}w.current&&(w.current.getTracks().forEach(t=>t.stop()),w.current=null),await y.current.initialize();let t=y.current.getStream();if(!t)throw Error("Failed to get audio stream");w.current=t;let a=t.getAudioTracks()[0];if(!a)throw Error("No audio track available");k.current&&await k.current.addAudioTrack(a,t),y.current.setMuted(o),e(!0),S("Microphone active")}catch(t){S("Failed to start recording:",t),d(e=>({...e,lastError:t instanceof Error?t.message:String(t),lastAction:"Failed to start recording"})),C()}finally{r(!1)}},[x,C,E,j,z,S,o]),T=(0,s.useCallback)(()=>{d({lastAction:"Call ended by user"}),C(),S("Recording stopped")},[C,S]),N=(0,s.useCallback)(()=>{if(y.current){let t=!o;y.current.setMuted(t),n(t),S("Microphone ".concat(t?"muted":"unmuted"))}},[o,S]);return(0,s.useEffect)(()=>()=>{C()},[C]),(0,s.useEffect)(()=>{let t,e;return f&&(t=setTimeout(()=>{p(!0),e=setTimeout(()=>{h(null),p(!1)},1500)},15e3)),()=>{clearTimeout(t),clearTimeout(e)}},[f]),{isMicActive:t,isProcessing:a,isConnected:u,isMuted:o,messages:i,debugInfo:c,currentVisualization:f,isVisualizationFading:g,selectedModel:x,startRecording:D,stopRecording:T,toggleMute:N}}(),[x,b]=(0,s.useState)([]),[v,y]=(0,s.useState)("");(0,s.useEffect)(()=>{navigator.mediaDevices.enumerateDevices().then(t=>{let e=t.filter(t=>"audioinput"===t.kind);b(e),e.length>0&&y(e[0].deviceId)}).catch(t=>{console.error("Error getting devices:",t)})},[]);let k=async()=>{t?g():await f()};return(0,r.jsxs)("main",{style:{height:"100vh",maxHeight:"100vh",width:"100vw",display:"flex",flexDirection:"column",alignItems:"center",position:"relative",overflow:"hidden",background:"#000",color:"#fff",fontFamily:"'Inter', sans-serif"},children:[(0,r.jsx)(h,{}),(0,r.jsx)("div",{style:{position:"fixed",top:"1rem",left:"1.5rem",width:"40px",height:"40px",transition:"opacity 0.2s ease-out",cursor:"pointer",opacity:1,display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:(0,r.jsxs)("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"none",stroke:"#4169E1",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M23 6l-9.5 9.5-5-5L1 18"}),(0,r.jsx)("path",{d:"M17 6h6v6"})]})}),(0,r.jsxs)("div",{style:{position:"relative",zIndex:2,textAlign:"center",marginTop:"1rem",marginBottom:"0.5rem"},children:[(0,r.jsx)("h1",{style:{fontSize:"clamp(1.25rem, 4vw, 2rem)",fontWeight:"bold",color:"#4169E1",animation:"titleGlow 2s ease-in-out infinite",marginBottom:"0.25rem",lineHeight:1.2,padding:"0 1rem"},children:"Vladislav Olegovich AI Solutions"}),(0,r.jsx)("h2",{style:{fontSize:"clamp(0.75rem, 2.5vw, 1rem)",color:"#87CEEB",fontWeight:"500",opacity:.9,marginBottom:"0.25rem"},children:"Where voices meet intelligence."})]}),(0,r.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",maxWidth:"300px",height:"600px",background:"rgba(0, 0, 0, 0.3)",borderRadius:"40px",border:"2px solid rgba(65, 105, 225, 0.3)",backdropFilter:"blur(10px)",display:"flex",flexDirection:"column",boxShadow:"0 0 30px rgba(65, 105, 225, 0.1)",zIndex:2,overflow:"hidden"},children:[(0,r.jsx)("div",{style:{width:"120px",height:"25px",background:"rgba(0, 0, 0, 0.8)",borderRadius:"0 0 20px 20px",margin:"0 auto"}}),(0,r.jsxs)("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"10px 15px",display:"flex",flexDirection:"column",WebkitOverflowScrolling:"touch"},children:[(0,r.jsx)(d,{messages:n}),c&&(0,r.jsx)("div",{style:{width:"100%",opacity:u?0:1,transition:"opacity 2s ease-out",marginTop:"10px"},children:(0,r.jsx)(T,{visualization:c})})]}),(0,r.jsx)("div",{style:{width:"40%",height:"4px",background:"rgba(65, 105, 225, 0.3)",borderRadius:"2px",margin:"10px auto"}})]}),(0,r.jsx)("div",{style:{position:"fixed",top:"1rem",right:"1.5rem",zIndex:100,padding:"0.5rem",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(10px)",border:"1px solid rgba(65, 105, 225, 0.2)",borderRadius:"0.5rem",color:"#4169E1",fontSize:"0.875rem",fontFamily:"inherit"},children:"Ultravox"}),(0,r.jsx)(i,{isMicActive:t,isProcessing:e,onClick:k,hasMessages:n.length>0,lastMessageIsAssistant:n.length>0&&"assistant"===n[n.length-1].type,isMuted:o,onMuteToggle:p}),l.lastError&&(0,r.jsx)("div",{style:{position:"fixed",bottom:"20%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:"280px",minHeight:"80px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",background:"rgba(0, 0, 0, 0.8)",padding:"1rem",borderRadius:"0.5rem",zIndex:10},children:(0,r.jsx)("div",{style:{fontSize:"0.875rem",color:"#fff",textAlign:"center",textShadow:"0 0 10px rgba(65, 105, 225, 0.2)"},children:l.lastError.startsWith("Error:")?l.lastError:l.lastAction})})]})}},6733:function(t){t.exports={messageContainer:"MessageList_messageContainer___pUTr",message:"MessageList_message__2DO7f",fadeIn:"MessageList_fadeIn__tGhV4",assistant:"MessageList_assistant__G7ANY",user:"MessageList_user__IKnxg"}},3542:function(t){t.exports={micButton:"MicButton_micButton___yJsc",muteButton:"MicButton_muteButton__nPXBj",micIcon:"MicButton_micIcon__MLeGi"}}},function(t){t.O(0,[205,481,365,971,117,744],function(){return t(t.s=7582)}),_N_E=t.O()}]);